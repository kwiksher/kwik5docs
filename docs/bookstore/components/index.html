<!doctype html><html><head><title>Kwik</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=revised content="2022-10-31T03:35:16 UTC"><title>Components :: Kwik</title><link rel="shortcut icon" href=/kwik5docs/images/favicon.png type=image/x-icon><link href=/kwik5docs/css/nucleus.css rel=stylesheet><link href=/kwik5docs/css/font-awesome.min.css rel=stylesheet><link href=/kwik5docs/css/featherlight.min.css rel=stylesheet><link href=/kwik5docs/css/auto-complete.css rel=stylesheet><link href=/kwik5docs/theme-flex/style.css rel=stylesheet><link rel=stylesheet href=/kwik5docs/css/bootstrap.min.css><meta name=description content></head><body data-url=/kwik5docs/bookstore/components/><header><div class=logo><a class=baselink href=https://kwiksher.github.io/kwik5docs/>Kwik</a></div><div class=burger><a href=javascript:void(0); style=font-size:15px>&#9776;</a></div><nav class=shortcuts><li role><a href=https://github.com/kwiksher/ rel=noopener><i class='fa fa-github'></i> <label>Github repo</label></a></li><li role><a href=https://github.com/vjeantet/hugo-theme-docdock/archive/master.zip rel=noopener><i class='fa fa-cloud-download'></i> <label>Download</label></a></li><li role><a href=https://gohugo.io/ rel=noopener><i class='fa fa-bookmark'></i> <label>Hugo Documentation</label></a></li><li role><a href=/kwik5docs/credits rel=noopener><i class='fa fa-bullhorn'></i> <label>Credits</label></a></li></nav></header><article><aside><ul class=menu><li data-nav-id=https://kwiksher.github.io/kwik5docs/introduction/ class=dd-item><div><a href=/kwik5docs/introduction/>Introduction</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/get_started/ class="dd-item haschildren"><div><a href=/kwik5docs/get_started/>Get Started</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i></div><ul><li data-nav-id=https://kwiksher.github.io/kwik5docs/get_started/step1/ class=dd-item><div><a href=/kwik5docs/get_started/step1/>Step 1 - UXP
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/get_started/step2/ class=dd-item><div><a href=/kwik5docs/get_started/step2/>Step2 - Solar2D
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/get_started/naming_rule/ class=dd-item><div><a href=/kwik5docs/get_started/naming_rule/>PSD Naming Rule
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/get_started/components/ class=dd-item><div><a href=/kwik5docs/get_started/components/>Components
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/get_started/events/ class=dd-item><div><a href=/kwik5docs/get_started/events/>Events & Commands
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/get_started/tools/ class=dd-item><div><a href=/kwik5docs/get_started/tools/>Tools
</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/ class="dd-item haschildren"><div><a href=/kwik5docs/design/>Design</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i></div><ul><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/architecture/ class=dd-item><div><a href=/kwik5docs/design/architecture/>Architecure
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/project_model/ class="dd-item haschildren"><div><a href=/kwik5docs/design/project_model/>Project Model</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i></div><ul><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/project_model/photoshop/ class=dd-item><div><a href=/kwik5docs/design/project_model/photoshop/>Photoshop File
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/project_model/icons/ class=dd-item><div><a href=/kwik5docs/design/project_model/icons/>Icons
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/project_model/content/ class=dd-item><div><a href=/kwik5docs/design/project_model/content/>Content X Structure
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/project_model/components/ class="dd-item haschildren"><div><a href=/kwik5docs/design/project_model/components/>Components</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i></div><ul><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/project_model/components/image/ class=dd-item><div><a href=/kwik5docs/design/project_model/components/image/>Image
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/project_model/components/animation/ class=dd-item><div><a href=/kwik5docs/design/project_model/components/animation/>Animation
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/project_model/components/audio/ class=dd-item><div><a href=/kwik5docs/design/project_model/components/audio/>Audio
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/project_model/components/button/ class=dd-item><div><a href=/kwik5docs/design/project_model/components/button/>Button
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/project_model/components/group/ class=dd-item><div><a href=/kwik5docs/design/project_model/components/group/>Group
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/project_model/components/spritesheet/ class=dd-item><div><a href=/kwik5docs/design/project_model/components/spritesheet/>Spritesheet
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/project_model/components/sync_audio_text/ class=dd-item><div><a href=/kwik5docs/design/project_model/components/sync_audio_text/>Sync Audio&Text
</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/project_model/template/ class=dd-item><div><a href=/kwik5docs/design/project_model/template/>Template strurcture
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/project_model/template_model/ class=dd-item><div><a href=/kwik5docs/design/project_model/template_model/>Template Model
</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/tools/ class="dd-item haschildren"><div><a href=/kwik5docs/design/tools/>Tools</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i></div><ul><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/tools/plugins/ class=dd-item><div><a href=/kwik5docs/design/tools/plugins/>UXP Plugins
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/tools/editor/ class=dd-item><div><a href=/kwik5docs/design/tools/editor/>Editor
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/tools/webapp/ class=dd-item><div><a href=/kwik5docs/design/tools/webapp/>REST Server
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/tools/utilities/ class=dd-item><div><a href=/kwik5docs/design/tools/utilities/>Utilities
</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/workflow/ class="dd-item haschildren"><div><a href=/kwik5docs/design/workflow/>Workflow</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i></div><ul><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/workflow/lua/ class=dd-item><div><a href=/kwik5docs/design/workflow/lua/>Lua Code
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/workflow/workflow/ class=dd-item><div><a href=/kwik5docs/design/workflow/workflow/>REST API
</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/sample-projects/ class=dd-item><div><a href=/kwik5docs/design/sample-projects/>Sample Projects</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/design/new_features/ class=dd-item><div><a href=/kwik5docs/design/new_features/>New Features
</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/bookstore/ class="dd-item haschildren"><div><a href=/kwik5docs/bookstore/>Bookstore</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i></div><ul><li data-nav-id=https://kwiksher.github.io/kwik5docs/bookstore/components/ class=dd-item><div><a href=/kwik5docs/bookstore/components/>Components
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/bookstore/steps/ class=dd-item><div><a href=/kwik5docs/bookstore/steps/>Steps
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/bookstore/server/ class=dd-item><div><a href=/kwik5docs/bookstore/server/>Book Server
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/bookstore/simulator/ class=dd-item><div><a href=/kwik5docs/bookstore/simulator/>Simulator
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/bookstore/versions/ class=dd-item><div><a href=/kwik5docs/bookstore/versions/>Book Versions
</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul></li><li data-nav-id=https://kwiksher.github.io/kwik5docs/all/ class=dd-item><div><a href=/kwik5docs/all/>all</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul><section></section></aside><section class=page><div class=nav-select><center>Navigation :
<select onchange="location.href=this.value"><option value=/kwik5docs/introduction/>
Introduction</option><option value=/kwik5docs/get_started/>
Get Started</option><option value=/kwik5docs/design/>
Design</option><option value=/kwik5docs/bookstore/>
Bookstore</option><option value=/kwik5docs/bookstore/components/ selected>- Components</option><option value=/kwik5docs/bookstore/steps/>- Steps</option><option value=/kwik5docs/bookstore/server/>- Book Server</option><option value=/kwik5docs/bookstore/simulator/>- Simulator</option><option value=/kwik5docs/bookstore/versions/>- Book Versions</option><option value=/kwik5docs/all/>
all</option></select></center></div><div><div class=searchbox><input data-search-input id=search-by type=text placeholder></div></div><div align=right>Last Modified: 2022-08-27</div><h1 id=components>Components</h1><p>bookstore consists of the following files and modules</p><nav id=TableOfContents><ul><li><a href=#photoshop-files>Photoshop files</a><ul><li><a href=#librarypsd>library.psd</a></li><li><a href=#dialogpsd>dialog.psd</a></li><li><a href=#tablepsd>table.psd</a></li></ul></li><li><a href=#solar2d-components>Solar2D components</a><ul><li><a href=#model>model</a></li><li><a href=#view>view</a></li><li><a href=#controller>controller</a></li></ul></li></ul></nav><h2 id=photoshop-files>Photoshop files</h2><h3 id=librarypsd>library.psd</h3><img src=../img/2022-08-07-14-48-27.png width=600><h3 id=dialogpsd>dialog.psd</h3><img src=../img/2022-08-07-14-48-56.png width=400><h3 id=tablepsd>table.psd</h3><img src=../img/2022-08-27-11-13-47.png width=600><hr><h2 id=solar2d-components>Solar2D components</h2><ul><li><p>App/bookTOC</p><pre tabindex=0><code>├── App
│   ├── bookFree
│   ├── bookOne
│   ├── bookTOC
|        ├── components
|        |      ├── library
|        |      |      ├── pages
|        |      |           └── bookstore.lua ⭐️
|        |      └── dialog
|        └── scenes
|              ├── library
|              |      ├── bg.lua
|              |      ├── bookFreeIcon.lua
|              |      ├── bookOneIcon.lua
|              |      ├── downloadBtn.lua
|              |      ├── purchaseBtn.lua
|              |      ├── restoreBtn.lua
|              |      ├── savedBtn.lua
|              |      ├── savingTxt.lua
|              |      └── index.lua　 ⭐️
|              └── dialog
|                     ├── bg.lua
|                     ├── bookIcon.lua
|                     ├── downloadBtn.lua
|                     ├── hideOverlayBtn.lua
|                     ├── infoTxt.lua
|                     ├── purchaseBtn.lua
|                     ├── savedBtn.lua
|                     ├── savingTxt.lua
|                     └── inddx.lua
│
├── components
    ├── bookstore
        ├── controller
        ├── model
        ├── smc
        ├── view
        ├── index.lua
        └── model.lua ⭐️
</code></pre></li></ul><p>bookstore component is defined in components.pages table. This calls bookstore.lua</p><ul><li><p>App/bookTOC/scenes/library/index.lua</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>  <span style=color:#00a8c8>local</span> <span style=color:#111>sceneName</span> <span style=color:#f92672>=</span> <span style=color:#111>...</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>--</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>local</span> <span style=color:#111>scene</span> <span style=color:#f92672>=</span> <span style=color:#111>require</span><span style=color:#111>(</span><span style=color:#d88200>&#39;controller.scene&#39;</span><span style=color:#111>).</span><span style=color:#111>new</span><span style=color:#111>(</span><span style=color:#111>sceneName</span><span style=color:#111>,</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>      <span style=color:#111>name</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;library&#34;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>      <span style=color:#111>layers</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>            <span style=color:#111>{</span>  <span style=color:#111>bg</span> <span style=color:#f92672>=</span><span style=color:#111>{</span> <span style=color:#111>}</span> <span style=color:#111>},</span>
</span></span><span style=display:flex><span>            <span style=color:#111>{</span>  <span style=color:#111>bookIcon</span> <span style=color:#f92672>=</span><span style=color:#111>{</span> <span style=color:#111>}</span> <span style=color:#111>},</span>
</span></span><span style=display:flex><span>            <span style=color:#111>...</span>
</span></span><span style=display:flex><span>            <span style=color:#111>...</span>
</span></span><span style=display:flex><span>      <span style=color:#111>},</span>
</span></span><span style=display:flex><span>      <span style=color:#111>components</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#111>audios</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span>  <span style=color:#111>},</span>
</span></span><span style=display:flex><span>        <span style=color:#111>groups</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span>  <span style=color:#111>},</span>
</span></span><span style=display:flex><span>        <span style=color:#111>timers</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span>  <span style=color:#111>},</span>
</span></span><span style=display:flex><span>        <span style=color:#111>variables</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span>  <span style=color:#111>},</span>
</span></span><span style=display:flex><span>        <span style=color:#111>pages</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span> <span style=color:#d88200>&#34;bookstore&#34;</span> <span style=color:#111>}</span>
</span></span><span style=display:flex><span>      <span style=color:#111>},</span>
</span></span><span style=display:flex><span>      <span style=color:#111>events</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span>  <span style=color:#111>},</span>
</span></span><span style=display:flex><span>      <span style=color:#111>onInit</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>function</span><span style=color:#111>(</span><span style=color:#111>scene</span><span style=color:#111>)</span> <span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#d88200>&#34;onInit&#34;</span><span style=color:#111>)</span> <span style=color:#00a8c8>end</span>
</span></span><span style=display:flex><span>  <span style=color:#111>})</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>--</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>return</span> <span style=color:#111>scene</span>
</span></span></code></pre></div></li><li><p>App/bookTOC/components/libary/pages/<strong>bookstore.lua</strong></p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span><span style=color:#00a8c8>local</span> <span style=color:#111>_M</span> <span style=color:#f92672>=</span> <span style=color:#111>{}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>local</span> <span style=color:#111>bookstore</span> <span style=color:#f92672>=</span> <span style=color:#111>require</span><span style=color:#111>(</span><span style=color:#d88200>&#34;components.bookstore.index&#34;</span><span style=color:#111>).</span><span style=color:#111>new</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>function</span> <span style=color:#75af00>_M</span><span style=color:#111>:</span><span style=color:#75af00>init</span><span style=color:#111>(</span><span style=color:#111>UI</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>end</span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>function</span> <span style=color:#75af00>_M</span><span style=color:#111>:</span><span style=color:#75af00>create</span><span style=color:#111>(</span><span style=color:#111>UI</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>local</span> <span style=color:#111>sceneGroup</span> <span style=color:#f92672>=</span> <span style=color:#111>UI.scene</span><span style=color:#111>.</span><span style=color:#111>view</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>local</span> <span style=color:#111>layers</span> <span style=color:#f92672>=</span> <span style=color:#111>UI.layers</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>--</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>--for k, v in pairs(UI.props) do print(k, v) end</span>
</span></span><span style=display:flex><span>  <span style=color:#111>bookstore</span><span style=color:#111>:</span><span style=color:#111>init</span><span style=color:#111>(</span><span style=color:#111>sceneGroup</span><span style=color:#111>,</span> <span style=color:#111>UI.props</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>end</span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>function</span> <span style=color:#75af00>_M</span><span style=color:#111>:</span><span style=color:#75af00>didShow</span><span style=color:#111>(</span><span style=color:#111>UI</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>local</span> <span style=color:#111>layers</span> <span style=color:#f92672>=</span> <span style=color:#111>UI.layers</span>
</span></span><span style=display:flex><span>  <span style=color:#111>bookstore</span><span style=color:#111>:</span><span style=color:#111>setSceneGroup</span><span style=color:#111>(</span><span style=color:#111>UI.scene</span><span style=color:#111>.</span><span style=color:#111>view</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>end</span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>function</span> <span style=color:#75af00>_M</span><span style=color:#111>:</span><span style=color:#75af00>toDispose</span><span style=color:#111>(</span><span style=color:#111>UI</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>  <span style=color:#111>bookstore</span><span style=color:#111>:</span><span style=color:#111>destory</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>end</span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>return</span> <span style=color:#111>_M</span>
</span></span></code></pre></div><p>bookstore.lua calls <strong>components.bookstore.model</strong></p></li></ul><hr><h3 id=model>model</h3><p>Please fill the bookstore model with values of each book</p><ul><li><p>compoents/bookstore/index.lua</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span><span style=color:#00a8c8>local</span> <span style=color:#111>M</span> <span style=color:#f92672>=</span> <span style=color:#111>{}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>local</span> <span style=color:#111>pageCommand</span> <span style=color:#f92672>=</span> <span style=color:#111>require</span><span style=color:#111>(</span><span style=color:#d88200>&#34;components.bookstore.controller.pageCommand&#34;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>local</span> <span style=color:#111>model</span> <span style=color:#f92672>=</span> <span style=color:#111>require</span><span style=color:#111>(</span><span style=color:#d88200>&#34;components.bookstore.model.base&#34;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#111>model.debug</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>true</span>
</span></span><span style=display:flex><span><span style=color:#111>model.URL</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;http://localhost:8080/bookshop/&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- model.URL = nil means simple IAP store without network download</span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- downloadBtn, savingTxt won&#39;T be used. You don&#39;t need to create them.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>----------</span>
</span></span><span style=display:flex><span><span style=color:#111>model.TOC</span>           <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;bookTOC&#34;</span>
</span></span><span style=display:flex><span><span style=color:#111>model.LIBRARY_PAGES</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#111>en</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;scenes.library&#34;</span><span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>model.DIALOG_PAGES</span>  <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#111>en</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;scenes.dialog&#34;</span><span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#111>model.name</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;catalog01&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#111>model.books</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>  <span style=color:#111>bookFree</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#111>name</span>         <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;bookFree&#34;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#111>versions</span>     <span style=color:#f92672>=</span> <span style=color:#111>{},</span>
</span></span><span style=display:flex><span>    <span style=color:#111>titles</span>       <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#111>en</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;bookOne&#34;</span><span style=color:#111>},</span>
</span></span><span style=display:flex><span>    <span style=color:#111>descriptions</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#111>en</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;desc&#34;</span><span style=color:#111>},</span>
</span></span><span style=display:flex><span>    <span style=color:#111>isFree</span>       <span style=color:#f92672>=</span> <span style=color:#00a8c8>true</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#111>isOnlineImg</span>  <span style=color:#f92672>=</span> <span style=color:#00a8c8>true</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#111>isDownloadable</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>true</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#111>image</span>        <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;App/bookFree/assets/images/page1/bg.png&#34;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#111>productNames</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#111>apple</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;bookFree&#34;</span><span style=color:#111>,</span> <span style=color:#111>google</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;bookFree&#34;</span><span style=color:#111>,</span> <span style=color:#111>amazon</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;bookFree&#34;</span><span style=color:#111>},</span>
</span></span><span style=display:flex><span>  <span style=color:#111>},</span>
</span></span><span style=display:flex><span>  <span style=color:#111>bookOne</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#111>name</span>         <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;bookOne&#34;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#111>versions</span>     <span style=color:#f92672>=</span> <span style=color:#111>{},</span>
</span></span><span style=display:flex><span>    <span style=color:#111>titles</span>       <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#111>en</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;bookOne&#34;</span><span style=color:#111>},</span>
</span></span><span style=display:flex><span>    <span style=color:#111>descriptions</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#111>en</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;desc&#34;</span><span style=color:#111>},</span>
</span></span><span style=display:flex><span>    <span style=color:#111>isFree</span>       <span style=color:#f92672>=</span> <span style=color:#00a8c8>false</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#111>isOnlineImg</span>  <span style=color:#f92672>=</span> <span style=color:#00a8c8>true</span><span style=color:#111>,</span> <span style=color:#75715e>-- true</span>
</span></span><span style=display:flex><span>    <span style=color:#111>isDownloadable</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>true</span><span style=color:#111>,</span> <span style=color:#75715e>-- true</span>
</span></span><span style=display:flex><span>    <span style=color:#111>image</span>        <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;App/bookOne/assets/images/page1/bg.png&#34;</span><span style=color:#111>,</span>
</span></span><span style=display:flex><span>    <span style=color:#111>productNames</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#111>apple</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;bookOne&#34;</span><span style=color:#111>,</span> <span style=color:#111>google</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;bookOne&#34;</span><span style=color:#111>,</span> <span style=color:#111>amazon</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;bookOne&#34;</span><span style=color:#111>},</span>
</span></span><span style=display:flex><span>  <span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#111>model.purchaseAlertMessages</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#111>en</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;Your purchase was successful&#34;</span><span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>model.restoreAlertMessages</span>  <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#111>en</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;Your items are being restored&#34;</span><span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>model.downloadErrorMessages</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#111>en</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;Check network alive to download the content&#34;</span><span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>model.descriptions</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#111>en</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;&#34;</span><span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>model.titles</span> <span style=color:#f92672>=</span> <span style=color:#111>{</span><span style=color:#111>en</span><span style=color:#f92672>=</span><span style=color:#d88200>&#34;&#34;</span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#111>model.gotoSceneEffect</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;slideRight&#34;</span>
</span></span><span style=display:flex><span><span style=color:#111>model.showOverlayEffect</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;slideBottom&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#111>M.new</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>function</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>return</span> <span style=color:#111>pageCommand.newBookstore</span><span style=color:#111>(</span><span style=color:#111>model</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>end</span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#111>M.model</span> <span style=color:#f92672>=</span> <span style=color:#111>model</span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>return</span> <span style=color:#111>M</span>
</span></span></code></pre></div><ul><li><p>debug</p><p>if true, IAPBadger is in debug mode.</p></li><li><p>URL</p><p>if book assets are downlodable, please set the server url</p></li><li><p>LIBRARY_PAGES</p><p>bookstore shows one of library page with lang value</p></li><li><p>DIALOG_PAGES</p><p>bookstore shows one of dialog with lang value</p></li><li><p>name</p><p>the name for IAP catalog. You may create another model.lua with a differnet name</p></li><li><p>books</p><ul><li><p>name</p></li><li><p>versions</p><p>you can put language codes for multilingual books.</p><blockquote><p>you may invent a new lang code for versions.
For example, instead of language code, use blue, red, gree of colors as version</p></blockquote></li><li><p>titles</p></li><li><p>descriptions</p></li><li><p>isFree</p><p>true or falase</p></li><li><p>isOnlineImg</p><p>if true, thumbnail image is loaded with the following given path in App folder</p><p>if false, from URL .."/"..image</p></li><li><p>image</p><p>thumbnail image path</p></li><li><p>productNames</p><p>if debug is false, productNames should be replaced with values of Apple store, Google play, Amazon store</p></li></ul></li></ul></li></ul><hr><h3 id=view>view</h3><p>You would like to customize the looks</p><p>marker</p><img src=../img/2020-09-09-15-52-26.png width=200><p>updateText</p><img src=../img/2020-09-09-16-04-31.png width=200><ul><li><p>components/bookstore/view/marker.lua</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span><span style=color:#00a8c8>local</span> <span style=color:#111>M</span> <span style=color:#f92672>=</span> <span style=color:#111>{}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>function</span> <span style=color:#75af00>M</span><span style=color:#111>.</span><span style=color:#75af00>new</span> <span style=color:#111>(</span><span style=color:#111>dst</span><span style=color:#111>,</span> <span style=color:#111>group</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#111>dst</span><span style=color:#111>,</span> <span style=color:#111>group</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>dst.updateMark</span> <span style=color:#f92672>==</span> <span style=color:#00a8c8>nil</span> <span style=color:#00a8c8>then</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>local</span> <span style=color:#111>obj</span> <span style=color:#f92672>=</span> <span style=color:#111>display.newCircle</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#ae81ff>4</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#111>obj.x</span> <span style=color:#f92672>=</span> <span style=color:#111>dst.x</span> <span style=color:#f92672>+</span> <span style=color:#111>dst.width</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        <span style=color:#111>obj.y</span> <span style=color:#f92672>=</span> <span style=color:#111>dst.y</span> <span style=color:#f92672>-</span> <span style=color:#111>dst.height</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        <span style=color:#111>obj</span><span style=color:#111>:</span><span style=color:#111>setFillColor</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#ae81ff>0</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#111>group</span><span style=color:#111>:</span><span style=color:#111>insert</span><span style=color:#111>(</span><span style=color:#111>obj</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#111>dst.updateMark</span> <span style=color:#f92672>=</span> <span style=color:#111>obj</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>else</span>
</span></span><span style=display:flex><span>        <span style=color:#111>dst.updateMark</span><span style=color:#111>.</span><span style=color:#111>alpha</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>end</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>end</span>
</span></span><span style=display:flex><span><span style=color:#75715e>---</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>return</span> <span style=color:#111>M</span>
</span></span></code></pre></div></li><li><p>components/bookstore/view/spinner.lua</p></li></ul><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span><span style=color:#00a8c8>local</span> <span style=color:#111>M</span> <span style=color:#f92672>=</span> <span style=color:#111>{}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>--</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>function</span> <span style=color:#75af00>M</span><span style=color:#111>.</span><span style=color:#75af00>new</span> <span style=color:#111>(</span><span style=color:#111>host</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>local</span> <span style=color:#111>obj</span> <span style=color:#f92672>=</span> <span style=color:#111>{}</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>local</span> <span style=color:#111>spinner</span>
</span></span><span style=display:flex><span>    <span style=color:#111>obj.host</span> <span style=color:#f92672>=</span> <span style=color:#111>host</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>--</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>function</span> <span style=color:#75af00>obj</span><span style=color:#111>:</span><span style=color:#75af00>show</span><span style=color:#111>(</span><span style=color:#111>host</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>if</span> <span style=color:#f92672>not</span> <span style=color:#111>spinner</span> <span style=color:#00a8c8>then</span>
</span></span><span style=display:flex><span>            <span style=color:#111>spinner</span> <span style=color:#f92672>=</span> <span style=color:#111>display.newGroup</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>local</span> <span style=color:#111>hostName</span> <span style=color:#f92672>=</span> <span style=color:#111>host</span> <span style=color:#f92672>or</span> <span style=color:#111>obj.host</span> <span style=color:#f92672>or</span> <span style=color:#d88200>&#34;&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>--Place a progress spinner on screen and tell the user the app is contating the store</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>local</span> <span style=color:#111>spinnerBackground</span> <span style=color:#f92672>=</span> <span style=color:#111>display.newRect</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#ae81ff>360</span><span style=color:#111>,</span><span style=color:#ae81ff>600</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>            <span style=color:#111>spinnerBackground</span><span style=color:#111>:</span><span style=color:#111>setFillColor</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>0.75</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>--Spinner consumes all taps so the user cannot tap the purchase button twice</span>
</span></span><span style=display:flex><span>            <span style=color:#111>spinnerBackground</span><span style=color:#111>:</span><span style=color:#111>addEventListener</span><span style=color:#111>(</span><span style=color:#d88200>&#34;tap&#34;</span><span style=color:#111>,</span> <span style=color:#00a8c8>function</span><span style=color:#111>()</span> <span style=color:#00a8c8>return</span> <span style=color:#00a8c8>true</span> <span style=color:#00a8c8>end</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>local</span> <span style=color:#111>spinnerText</span> <span style=color:#f92672>=</span> <span style=color:#111>display.newText</span><span style=color:#111>(</span><span style=color:#d88200>&#34;Contacting &#34;</span> <span style=color:#f92672>..</span> <span style=color:#111>hostName</span> <span style=color:#f92672>..</span> <span style=color:#d88200>&#34;...&#34;</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>20</span><span style=color:#111>,</span> <span style=color:#111>native.systemFont</span><span style=color:#111>,</span> <span style=color:#ae81ff>18</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>            <span style=color:#111>spinnerText</span><span style=color:#111>:</span><span style=color:#111>setFillColor</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#ae81ff>0</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>--Add a little spinning rectangle</span>
</span></span><span style=display:flex><span>            <span style=color:#00a8c8>local</span> <span style=color:#111>spinnerRect</span> <span style=color:#f92672>=</span> <span style=color:#111>display.newRect</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#ae81ff>35</span><span style=color:#111>,</span><span style=color:#ae81ff>35</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>            <span style=color:#111>spinnerRect</span><span style=color:#111>:</span><span style=color:#111>setFillColor</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>            <span style=color:#111>spinnerRect</span><span style=color:#111>:</span><span style=color:#111>setStrokeColor</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>            <span style=color:#111>spinnerRect.strokeWidth</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>            <span style=color:#111>transition.to</span><span style=color:#111>(</span><span style=color:#111>spinnerRect</span><span style=color:#111>,</span> <span style=color:#111>{</span> <span style=color:#111>time</span><span style=color:#f92672>=</span><span style=color:#ae81ff>4000</span><span style=color:#111>,</span> <span style=color:#111>rotation</span><span style=color:#f92672>=</span><span style=color:#ae81ff>360</span><span style=color:#111>,</span> <span style=color:#111>iterations</span><span style=color:#f92672>=</span><span style=color:#ae81ff>999999</span><span style=color:#111>,</span> <span style=color:#111>transition</span><span style=color:#f92672>=</span><span style=color:#111>easing.inOutQuad</span><span style=color:#111>})</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>--Create a group and add all these objects to it</span>
</span></span><span style=display:flex><span>            <span style=color:#111>spinner</span><span style=color:#111>:</span><span style=color:#111>insert</span><span style=color:#111>(</span><span style=color:#111>spinnerBackground</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>            <span style=color:#111>spinner</span><span style=color:#111>:</span><span style=color:#111>insert</span><span style=color:#111>(</span><span style=color:#111>spinnerText</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>            <span style=color:#111>spinner</span><span style=color:#111>:</span><span style=color:#111>insert</span><span style=color:#111>(</span><span style=color:#111>spinnerRect</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>            <span style=color:#111>spinner.x</span><span style=color:#111>,</span> <span style=color:#111>spinner.y</span> <span style=color:#f92672>=</span> <span style=color:#111>_W</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span><span style=color:#111>,</span> <span style=color:#111>_H</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>            <span style=color:#111>spinner.spinnerText</span> <span style=color:#f92672>=</span> <span style=color:#111>spinnerText</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>end</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>end</span>
</span></span></code></pre></div><ul><li><p>updateText</p><ul><li>startTime: the start time of a book download</li><li>size: the size in progress</li><li>bookSize:the total size of assets of a book</li></ul><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span><span style=color:#00a8c8>function</span> <span style=color:#75af00>obj</span><span style=color:#111>:</span><span style=color:#75af00>updateText</span><span style=color:#111>()</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>local</span> <span style=color:#111>percent</span> <span style=color:#f92672>=</span> <span style=color:#111>self.size</span><span style=color:#f92672>/</span><span style=color:#111>self.bookSize</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>local</span> <span style=color:#111>sec</span>     <span style=color:#f92672>=</span> <span style=color:#111>os.difftime</span><span style=color:#111>(</span> <span style=color:#111>os.time</span><span style=color:#111>(),</span> <span style=color:#111>self.startTime</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>local</span> <span style=color:#111>remain</span>  <span style=color:#f92672>=</span> <span style=color:#111>math.floor</span><span style=color:#111>(</span><span style=color:#111>sec</span> <span style=color:#f92672>*</span> <span style=color:#111>(</span><span style=color:#ae81ff>1.0</span><span style=color:#f92672>/</span><span style=color:#111>percent</span><span style=color:#111>))</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>local</span> <span style=color:#111>time</span>    <span style=color:#f92672>=</span> <span style=color:#111>os.date</span><span style=color:#111>(</span><span style=color:#d88200>&#34;*t&#34;</span><span style=color:#111>,</span> <span style=color:#111>remain</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#111>self.spinnerText</span><span style=color:#111>.</span><span style=color:#111>text</span> <span style=color:#f92672>=</span> <span style=color:#111>math.floor</span><span style=color:#111>(</span><span style=color:#111>percent</span><span style=color:#f92672>*</span><span style=color:#ae81ff>100</span><span style=color:#111>)</span><span style=color:#f92672>..</span><span style=color:#d88200>&#34; % (&#34;</span> <span style=color:#f92672>..</span><span style=color:#111>self.size</span> <span style=color:#f92672>..</span><span style=color:#d88200>&#34;/&#34;</span> <span style=color:#f92672>..</span><span style=color:#111>self.bookSize</span> <span style=color:#f92672>..</span><span style=color:#d88200>&#34; Mb) </span><span style=color:#8045ff>\n</span><span style=color:#d88200> left &#34;</span> <span style=color:#f92672>..</span><span style=color:#111>time.min</span><span style=color:#f92672>..</span><span style=color:#d88200>&#34;:&#34;</span><span style=color:#f92672>..</span><span style=color:#111>time.sec</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>end</span>
</span></span></code></pre></div></li></ul><hr><h3 id=controller>controller</h3><p>These functions are available for page&book navigation. You can set it for an event action.</p><ul><li>components/bookstore/controller/pageCommand.lua<ul><li>gotoTOC()</li><li>showView(page, options)</li><li>gotoSceneBook(book, page, version)</li><li>gotoSceneNextBook(version)</li><li>gotoScenePreviousBook(version)</li><li>gotoScene(event, version)<ul><li>event = {target = {selectedPurchase= &ldquo;bookOne&rdquo;}}</li></ul></li></ul></li></ul><div class=chevrons><div id=navigation><a class="nav nav-prev" href=/kwik5docs/bookstore/ title=Bookstore><i class="fa fa-chevron-left"></i><label>Bookstore</label></a>
<a class="nav nav-next" href=/kwik5docs/bookstore/steps/ title=Steps style=margin-right:0><label>Steps</label><i class="fa fa-chevron-right"></i></a></div></div></section></article><footer><div class=footline><div class=date><i class='fa fa-calendar'></i> 27/08/2022</div><div class=github-link><a href=https://github.com/vjeantet/hugo-theme-docdock/edit/master/exampleSite/content/bookstore/components.md target=blank><i class="fa fa-code-fork"></i></a></div></div><div></div></footer><script src=/kwik5docs/js/jquery-2.x.min.js></script>
<script type=text/javascript>var baseurl="https://kwiksher.github.io/kwik5docs/"</script><script src=/kwik5docs/js/clipboard.min.js></script>
<script src=/kwik5docs/js/featherlight.min.js></script>
<script type=text/javascript src=/kwik5docs/js/lunr.min.js></script>
<script type=text/javascript src=/kwik5docs/js/auto-complete.js></script>
<script type=text/javascript src=/kwik5docs/js/search.js></script>
<script src=/kwik5docs/theme-flex/script.js></script>
<script src=https://kwiksher.github.io/kwik5docs/js/scripts.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.12.0/mermaid.min.js crossorigin=anonymous></script>
<script>mermaid.init(void 0,".language-mermaid")</script></body></html>